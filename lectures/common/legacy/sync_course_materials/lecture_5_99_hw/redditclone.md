# Backend для клона реддита

Выполнение этого задания даст вам комплексное представление о разработке сайта под веб. Выполнив это ( и следующее ) задание вы получите все базовые навыки, которые нужны в работе.
Это наверное самая важная домашка в курсе.

-----

Есть замечательный клон реддита ( <https://www.reddit.com/> )

* <https://asperitas.vercel.app/> - веб-версия (бывает что работает, бывает что нет)
* <https://github.com/d11z/asperitas> - исходники (всё на JS, и бэк и фронт)
* <https://github.com/jtwool/asperitas> - форк исходников, где добавлен docker-compose. можно поднять пример локально, если хочется

К счастью, фронтенд полностью работает на JS и требует от вас только отдать нужную статику: хтмл, который подключит весь JS, а последний уже будет делать AJAX-запросы к беку.

Бек и предстоит реализовать. Все апи будет отдавать данные в формате JSON

У вас будут следующие апи-методы:

1) POST /api/register - регистрация
2) POST /api/login - логин
3) GET /api/posts/ - список всех постов
4) POST /api/posts/ - добавление поста - обратите внимание - есть с урлом, а есть с текстом
5) GET /api/posts/{CATEGORY_NAME} - список постов конкретной категории
6) GET /api/post/{POST_ID} - детали поста с комментами
7) POST /api/post/{POST_ID} - добавление коммента
8) DELETE /api/post/{POST_ID}/{COMMENT_ID} - удаление коммента
9) GET /api/post/{POST_ID}/upvote - рейтинг поста вверх
10) GET /api/post/{POST_ID}/downvote - рейтинг поста вниз
11) GET /api/post/{POST_ID}/unvote - отмена голоса 
12) DELETE /api/post/{POST_ID} - удаление поста
13) GET /api/user/{USER_LOGIN} - получение всех постов конкретного пользователя

Внутри у вас будут следующие сущности:

1) Пользователь
2) Пост
3) Коммент к посту

Требования:

1) модули - было на 4 лекции
2) структура проекта - <https://github.com/golang-standards/project-layout> - было на 5-й лекции (7_crudapp)
3) данные хранятся в памяти, везде есть мьютексы
4) полная работоспособность всего функционала при запуске приложения
5) корректная работа от разных пользователей
6) глобальные переменные для хранения данных использовать нельзя, все через паттерн репозиторий (7_crudapp)

Как смотреть в каком формате фронтенд ожидает ответ от апи:

1) <https://s.mail.ru/FXHM/33xRndiyK>
2) Открыть сайт <https://asperitas.now.sh/> (либо локальную копию через докер - https://github.com/jtwool/asperitas)
3) Открыть консоль ( в Chrome - F12 )
4) Выбрать секцию Network
5) Выбрать XHR - это покажет только аякс-запросы
6) Кликнуть на запрос
7) В секции Headers->Request Headers при постинге коммента можно найти заголовок authorization - так клиент отправляет авторизацию
8) В секции Preview можно найти ответ

Смотрим ответ, пишем код, который будет отдавать точно такой же ответ.
Либо можно посмотреть JS код в https://github.com/d11z/asperitas

* фронтенд-часть находится в папке redditclone/static, index.html надо отдать гошным сервисом корне ( / ), js и css - как статику, тоже гошным кодом
* Отдача статики была в 3-й лекции
* Отдача шаблона была в 4-й лекции
* В качестве роутинга можно использовать стандартный роутер (https://go.dev/blog/routing-enhancements), либо gorilla/mux
* Сессии используются через jwt, смотрите пример в папке jwt_example, внутренности того что возвращается в jwt - <https://jwt.io/> - вы должны вернуть ровно то же самое
* пример того как может выглядеть проект (как раскидать всякое разное по папкам) <https://github.com/golang-standards/project-layout>
